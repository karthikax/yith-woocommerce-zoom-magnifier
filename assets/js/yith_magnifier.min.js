/**
 * YITH Magnifier
 * 
 * @version 0.1
 * @author Your Inspiration Themes Team <info@yithemes.com>
 *
 * MIT License.
 */
(function(s,b,q){if(b.fn.imagesLoaded===q){var g=jQuery,r="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";g.fn.imagesLoaded=function(a){function b(){var d=g(k),e=g(j);c&&(j.length?c.reject(h,d,e):c.resolve(h));g.isFunction(a)&&a.call(p,h,d,e)}function e(a){f(a.target,"error"===a.type)}function f(a,f){a.src===r||-1!==g.inArray(a,m)||(m.push(a),f?j.push(a):k.push(a),g.data(a,"imagesLoaded",{isBroken:f,src:a.src}),l&&c.notifyWith(g(a),[f,h,g(k),g(j)]),h.length===m.length&&(setTimeout(b),
    h.unbind(".imagesLoaded",e)))}var p=this,c=g.isFunction(g.Deferred)?g.Deferred():0,l=g.isFunction(c.notify),h=p.find("img").add(p.filter("img")),m=[],k=[],j=[];g.isPlainObject(a)&&g.each(a,function(b,d){if("callback"===b)a=d;else if(c)c[b](d)});h.length?h.bind("load.imagesLoaded error.imagesLoaded",e).each(function(a,b){var c=b.src,d=g.data(b,"imagesLoaded");if(d&&d.src===c)f(b,d.isBroken);else if(b.complete&&void 0!==b.naturalWidth)f(b,0===b.naturalWidth||0===b.naturalHeight);else if(b.readyState||
    b.complete)b.src=r,b.src=c}):b();return c?c.promise(p):p}}b.yith_magnifier=function(a,d){this.t=d;this.element=b(d);this._init(a)};b.yith_magnifier.defaults={zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:0.5,lensOpacity:0.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:0.5,adjustX:0,adjustY:0,phoneBehavior:"inside",loadingLabel:"Loading...",enableSlider:!0,sliderOptions:{},onLoad:function(){return!1},onEnter:function(){return!1},onLeave:function(){return!1},onMove:function(){return!1},
    onClick:function(){return!1},elements:{zoom:b(".yith_magnifier_zoom"),zoomImage:b(".yith_magnifier_zoom img"),gallery:b(".yith_magnifier_gallery li a")}};b.yith_magnifier.prototype={_init:function(a){var d=this;b.each(b.yith_magnifier.defaults.elements,function(a,f){b.yith_magnifier.defaults.elements[a]=b(f,d)});d.options=b.extend(!0,{},b.yith_magnifier.defaults,a);d.isPhone=d._isPhone();d._loading();d.element.imagesLoaded(function(){d.options.onLoad();d._initZoom();d._initGallery()})},_initGallery:function(){var a=
    this,d=a.options.elements,e=d.gallery,f=d.zoom,g=d.zoomImage;if(0<e.length)e.on("click",function(c){c.preventDefault();c=b(this);a.destroy();f.attr("href",this.href);g.attr("src",c.data("small")).attr("title","").attr("title",c.attr("title"));b.data(a.t,"yith_magnifier",new b.yith_magnifier(a.options,a.element))}),a.options.enableSlider&&e.parents("ul").carouFredSel(a.options.sliderOptions);else e.on("click",function(a){a.preventDefault();return!1})},_loading:function(){if(this.options.disableRightClick)b(document).on("contextmenu",
    function(){return!1});if(this.mouseTrap===q){var a=this.options.elements.zoom.width();b('<div class="yith_magnifier_loading">'+this.options.loadingLabel+"</div>").css({width:a/3,left:a/2-a/6,opacity:0.5}).appendTo(this.options.elements.zoom.parent())}},_initZoom:function(){var a=this;a.zoom=a.options.elements.zoom;a.zoomImage=a.options.elements.zoomImage;a.zoom.wrap('<div class="yith_magnifier_zoom_wrap"></div>');a.IMG_zoomImage=new Image;a.IMG_zoomImage.src=a.zoom.attr("href");a.IMG_smallImage=new Image;
    a.IMG_smallImage.src=a.zoomImage.attr("src");b.browser.msie&&8==b.browser.version?b(a.IMG_zoomImage).load(function(){a._initTrap()}):b([a.IMG_zoomImage,a.IMG_smallImage]).imagesLoaded(function(){a._initTrap()})},_initTrap:function(){var a=this,d=a.IMG_zoomImage;a.mx=0;a.my=0;a.controlTimer=0;a.lens=null;a.tint=null;a.softFocus=null;a.zoomDiv=null;a.cw=0;a.ch=0;a.zw=0;a.destU=0;a.destV=0;a.currU=0;a.currV=0;a.mouseTrap=null;var e=a.options.elements.zoom,f=a.options.elements.zoomImage;b(".yith_magnifier_loading").remove();
    this.element.find(".yith_magnifier_mousetrap")&&this.element.find(".yith_magnifier_mousetrap").remove();this.mouseTrap=b('<div class="yith_magnifier_mousetrap" />').css({width:"100%",height:"100%",top:0,left:0}).appendTo(e.parent());var g="ontouchstart"in document.documentElement?!0:!1;this.mouseTrap.on("touchmove mousemove",this,function(b){a.options.onMove();a.mx="undefined"!=typeof b.originalEvent.touches?b.originalEvent.touches[0].pageX:b.pageX;a.my="undefined"!=typeof b.originalEvent.touches?
        b.originalEvent.touches[0].pageY:b.pageY}).on("touchend mouseleave",this,function(){clearTimeout(a.controlTimer);a.lens&&a.lens.fadeOut(299);a.tint&&a.tint.fadeOut(299);a.softFocus&&a.softFocus.fadeOut(299);a.zoomDiv.fadeOut(300,function(){a._onLeave()});return!1}).on("touchstart click",this,function(){a.options.onClick()}).on("touchstart mouseenter",this,function(c){a.options.onEnter();g&&c.preventDefault();a.mx="undefined"!=typeof c.originalEvent.touches?c.originalEvent.touches[0].pageX:c.pageX;
            a.my="undefined"!=typeof c.originalEvent.touches?c.originalEvent.touches[0].pageY:c.pageY;a.zw=c.data;a.zoomDiv&&(a.zoomDiv.stop(!0,!1),a.zoomDiv.remove());c=a.options.adjustX;var l=a.options.adjustY,h=f.outerWidth(),m=f.outerHeight(),k=a.options.zoomWidth,j=a.options.zoomHeight;"auto"==a.options.zoomWidth&&(k=h);"auto"==a.options.zoomHeight&&(j=m);var n=e.parent();switch(a.options.position){case "top":l-=j;break;case "right":c+=h;break;case "bottom":l+=m;break;case "left":c-=k;break;case "inside":k=
                h;j=m;break;default:n=b("#"+a.options.position),n.length?(k=n.innerWidth(),j=n.innerHeight()):(n=e,c+=h,l+=m)}a.isPhone&&"inside"==a.options.phoneBehavior&&(k=h,j=m,l=c=0);a.zoomDiv=b('<div class="yith_magnifier_zoom_magnifier" />').css({left:c,top:l,width:k,height:j,backgroundImage:"url("+d.src+")"}).appendTo(n);f.attr("title")&&a.options.showTitle&&b('<div class="yith_magnifier_title">'+f.attr("title")+"</div>").appendTo(a.zoomDiv);a.isPhone?"disable"!=a.options.phoneBehavior?a.zoomDiv.fadeIn(500):
                a.lens.fadeOut(299):a.zoomDiv.fadeIn(500);a.lens&&(a.lens.remove(),a.lens=null);a.cw=1>=d.width?f.outerWidth()/d.naturalWidth*a.zoomDiv.width():f.outerWidth()/d.width*a.zoomDiv.width();a.ch=1>=d.height?f.outerHeight()/d.naturalHeight*a.zoomDiv.height():f.outerHeight()/d.height*a.zoomDiv.height();a.lens=b('<div class="yith_magnifier_lens" />').css({width:a.cw,height:a.ch}).appendTo(e);a.mouseTrap.css("cursor",a.lens.css("cursor"));c=!1;a.options.tint&&(a.tint=b("<div />").css({display:"none",position:"absolute",
                left:0,top:0,width:f.outerWidth(),height:f.outerHeight(),backgroundColor:a.options.tint,opacity:a.options.tintOpacity}).appendTo(e),a.lens.append(b("<img />",{src:f.attr("src")})),c=!0,a.tint.fadeIn(500));a.options.softFocus&&(a.softFocus=b("<div />").css({position:"absolute",display:"none",top:"1px",left:"1px",width:f.outerWidth(),height:f.outerHeight(),opacity:0.5}).appendTo(e),a.softFocus.append(b("<img />",{src:f.attr("src")})),0==a.lens.find("img").length&&a.lens.append(b("<img />",{src:f.attr("src")})),
                c=!0,a.softFocus.fadeIn(500));c||a.lens.css("opacity",a.options.lensOpacity);"inside"!==a.options.position&&a.lens.fadeIn(500);a.zw._controlLoop()})},_controlLoop:function(){var a=this;if(this.lens){var b=this.mx-this.zoomImage.offset().left-0.5*this.cw>>0,e=this.my-this.zoomImage.offset().top-0.5*this.ch>>0;0>b?b=0:b>this.zoomImage.outerWidth()-this.cw&&(b=this.zoomImage.outerWidth()-this.cw);0>e?e=0:e>this.zoomImage.outerHeight()-this.ch&&(e=this.zoomImage.outerHeight()-this.ch);this.lens.css({left:b-
    2,top:e-1});this.lens.find("img").css({width:this.zoomImage.outerWidth(),height:this.zoomImage.outerHeight(),marginLeft:-b+"px ",marginTop:-e+"px"});this.destU=1>=this.IMG_zoomImage.width?b/this.zoomImage.outerWidth()*this.IMG_zoomImage.naturalWidth>>0:b/this.zoomImage.outerWidth()*this.IMG_zoomImage.width>>0;this.destV=1>=this.IMG_zoomImage.height?e/this.zoomImage.outerHeight()*this.IMG_zoomImage.naturalHeight>>0:e/this.zoomImage.outerHeight()*this.IMG_zoomImage.height>>0;this.currU+=(this.destU-
    this.currU)/this.options.smoothMove;this.currV+=(this.destV-this.currV)/this.options.smoothMove;this.zoomDiv.css("background-position",-(this.currU>>0)+"px "+(-(this.currV>>0)+"px"))}this.controlTimer=setTimeout(function(){a._controlLoop()},30)},_onLeave:function(){this.options.onLeave();this.zoomDiv&&(this.zoomDiv.remove(),this.zoomDiv=null);this._removeElements()},_removeElements:function(){this.lens&&(this.lens.remove(),this.lens=null);this.tint&&(this.tint.remove(),this.tint=null);this.softFocus&&
(this.softFocus.remove(),this.softFocus=null);0<this.element.find(".yith_magnifier_loading").length&&this.element.find(".yith_magnifier_loading").remove()},_isPhone:function(){var a=navigator.userAgent.toLowerCase();return a.match(/iphone/i)||a.match(/ipod/i)||a.match(/android/i)},destroy:function(){this.zoom&&this.zoom.unwrap();this.mouseTrap&&(this.mouseTrap.unbind(),this.mouseTrap.remove(),this.mouseTrap=null);this.zoomDiv&&(this.zoomDiv.remove(),this.zoomDiv=null);this.options.disableRightClick&&
b(document).unbind();this._removeElements();this.options.elements.gallery.unbind();this.element.removeData("yith_magnifier")}};b.fn.yith_magnifier=function(a){if("string"===typeof a){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var e=b.data(this,"yith_magnifier");e?!b.isFunction(e[a])||"_"===a.charAt(0)?b.error("no such method '"+a+"' for yith_magnifier instance"):e[a].apply(e,d):b.error("cannot call methods on yith_magnifier prior to initialization; attempted to call method '"+
    a+"'")})}else this.each(function(){b.data(this,"yith_magnifier")?b.error("yith_magnifier already istantiated."):b.data(this,"yith_magnifier",new b.yith_magnifier(a,this))});return this}})(window,jQuery);